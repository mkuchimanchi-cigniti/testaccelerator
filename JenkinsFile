pipeline {
   agent any

   stages {
      stage('Pull code') {
         steps {
	    cleanWs()
            git changelog: false, branch: 'main', credentialsId: '4573c33d-b90f-4656-a27e-0bd7f3760d46', poll: false, url: 'https://github.com/mkuchimanchi-cigniti/testaccelerator.git'
         }
         
      }
       stage('Build & Package') {
        steps {
            bat label: '', script: 'mvn package'
         
         }
         
      }
	  stage('SonarQube Scan') 
			{							
				steps {
				  
				   
					script{
						def scannerHome = tool 'sonarqube';
						withSonarQubeEnv{
						    bat "\"${scannerHome}\"\\bin\\sonar-scanner "+
							"-Dsonar.projectKey=TestAccelerator "+
							"-Dsonar.projectName=TestAccelerator "+
							"-Dsonar.projectVersion=${BUILD_NUMBER} "+
							"-Dsonar.sources=src/main/ "+
							"-Dsonar.java.binaries=src/main/"
						}
					}					
				}					
			}    
			
		stage('Run UnitTests') {
        steps {
           echo "Running Unit Tests"
         
         }
		 }
        stage('Upload Artifacts') {
        steps {
           echo "Uploaded Artifacts"
         
         }  
		 }
		 stage('Deploy Application') {
        steps {
           echo "Application Deployed"
         
         }  
      }	
     
}

   
}
